<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	lang="#{languageBean.language}">
<f:view locale="#{languageBean.locale}">
<ui:insert name="metadata"/>
<h:head>
	<title>Glue</title>
	<meta name="description" content="Glue est un moteur de recherche d'événements culturels." />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="icon" type="image/png" href="#{resource['img:favicon.png']}" />
	<!-- Bootstrap -->
	<h:outputStylesheet library="css" name="bootstrap.min.css"
		media="screen" />
	<h:outputStylesheet library="css" name="typeahead.js-bootstrap.css"
		media="screen" />
	<h:outputStylesheet library="css" name="glue.css" media="screen" />
	<h:outputStylesheet library="css" name="font-awesome.min.css"
		media="screen" />
	
	<!-- Additional stylesheets -->	
	<ui:insert name="stylesheet"/>	

	<script type="text/javascript"
		src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;sensor=false&amp;libraries=places"></script>
	<h:outputScript library="js" name="geolocation.js" />
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	
	  ga('create', 'UA-45640046-1', '91.121.106.99');
	  ga('send', 'pageview');
	
	</script>

</h:head>
<h:body>
	<div id="fb-root"></div>
	<script>
		(function(d, s, id) {
			var js, fjs = d.getElementsByTagName(s)[0];
			if (d.getElementById(id))
				return;
			js = d.createElement(s);
			js.id = id;
			js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
			fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));
	</script>

	<div id="glue-feedback">
		<a class="btn btn-danger" data-toggle="modal"
			data-controls-modal="feedback" data-backdrop="static"
			data-keyboard="false" href="#feedback">Feedback</a>
	</div>

	<nav class="navbar navbar-default navbar-fixed-top glue-navbar-default"
		role="navigation">
	<!-- <div class="container"> -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse"
				data-target=".navbar-ex1-collapse">
				<span class="sr-only">Toggle navigation</span><span
					class="icon-bar"></span> <span class="icon-bar"></span> <span
					class="icon-bar"></span>
			</button>

			<h:link class="navbar-brand glue-brand" outcome="main">
				<h:graphicImage library="img" name="glue-icon.svg" width="25"
					style="vertical-align:top; position: relative; top: -7px;" />
				<span class="text-muted">glue</span>
			</h:link>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse navbar-ex1-collapse">

			<h:form id="main_form" prependId="false"
				styleClass="navbar-form navbar-left" role="search">
				<h:inputHidden id="inputLat" value="#{eventSearchBean.latitude}" />
				<h:inputHidden id="inputLng" value="#{eventSearchBean.longitude}" />
				<div class="form-group">
					<h:inputText id="q" styleClass="typeahead form-control" style="min-width: 300px;"
						p:placeholder="#{bundle.search}" value="#{eventSearchBean.query}" />
				</div>
				<div class="form-group">
					<div class="input-group" style="width: 196px;">
						<span class="input-group-btn">
							<button id="btnLocation" class="btn btn-default glue-glyphicon-btn" type="button"
								title="#{bundle.current_position}"
								onclick="getCurrentPosition()">
								<span class="glyphicon glyphicon-map-marker text-muted"></span>
							</button>
						</span>
						<h:inputText id="inputLocation" styleClass="form-control"
							p:placeholder="#{bundle.location}"
							value="#{eventSearchBean.location}"></h:inputText>
					</div>
				</div>
				<div class="form-group">
					<h:commandLink action="#{eventSearchBean.search0}"
						styleClass="btn btn-primary glue-glyphicon-btn-lg">
						<span class="glyphicon glyphicon-search"></span>						
					</h:commandLink>
				</div>
				<h:commandButton id="search_input" action="#{eventSearchBean.search0}"
					style="display:none;" />				
			</h:form>

			<h:form>
				<ul class="nav navbar-nav navbar-right">
					<ui:fragment rendered="#{not empty request.remoteUser}">
						<!-- <li><h:link outcome="/stream/create"
								title="#{bundle.create_stream}">
								<span class="glyphicon glyphicon-plus-sign"></span>
							</h:link></li>
						<li><a href="#"><span class="badge">42</span></a></li> -->
						<li class="dropdown"><a class="dropdown-toggle"
							data-toggle="dropdown" href="#"> #{request.remoteUser} <span
								class="caret"></span>
						</a>
							<ul class="dropdown-menu">
								<li><a href="#"><span class="glyphicon glyphicon-cog"></span>&nbsp;<h:outputText
											value="#{bundle.account_settings}" /></a></li>
								<li><a href="#"><span
										class="glyphicon glyphicon-filter"></span>&nbsp;<h:outputText
											value="#{bundle.search_filters}" /></a></li>
								<li><h:commandLink action="#{loginBean.logout}">
										<span class="glyphicon glyphicon-log-out"></span>&nbsp;<h:outputText
											value="#{bundle.logout}" />
									</h:commandLink></li>
							</ul></li>
					</ui:fragment>
					<ui:fragment rendered="#{empty request.remoteUser}">
						<li><h:link value="#{bundle.sign_in}" outcome="login"
								class="navbar-text" disabled="true"
								title="#{bundle.feature_not_available}" /></li>
						<li><h:link value="#{bundle.sign_up}" outcome="register"
								class="navbar-text" disabled="true"
								title="#{bundle.feature_not_available}" /></li>
					</ui:fragment>
				</ul>
			</h:form>
		</div>

		<!--/.nav-collapse -->
	<!-- </div> -->
	</nav>

	<!-- Feedback modal window -->
	<div id="feedback" class="modal fade in" tabindex="-1" role="dialog">
		<div class="modal-dialog">
			<div class="modal-content">
				<h:form id="feedback-form" class="form-horizontal">
					<div class="modal-header">
						<h4 class="modal-title">
							<h:outputText value="#{bundle.feedback_title}"></h:outputText>
						</h4>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label class="col-lg-2 control-label" for="feedback-subject">
								<h:outputText value="#{bundle.feedback_subject}"></h:outputText>
							</label>
							<div class="col-lg-10">
								<h:inputText id="feedback-subject" styleClass="form-control"
									value="#{feedbackBean.subject}"
									p:placeholder="Bug, remark, new idea ..." />
							</div>
						</div>
						<div class="form-group">
							<label class="col-lg-2 control-label" for="feedback-mail">
								<h:outputText value="#{bundle.feedback_mail}"></h:outputText>
							</label>
							<div class="col-lg-10">
								<h:inputText id="feedback-mail" styleClass="form-control"
									value="#{feedbackBean.mailAddress}"
									p:placeholder="you@exemple.com"
									validatorMessage="#{bundle.feedback_mail_error}">
									<f:validateRegex pattern="(.+@.+\.[a-zA-Z]+)?" />
									<f:ajax event="valueChange" render="feedback-mail-msg" />
								</h:inputText>
								<h:message id="feedback-mail-msg" for="feedback-mail"
									style="color: red" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-lg-2 control-label" for="feedback-message">
								<h:outputText value="#{bundle.feedback_message}"></h:outputText>
							</label>
							<div class="col-lg-10">
									<h:inputTextarea id="feedback-message"
										styleClass="form-control" value="#{feedbackBean.message}"
										rows="8" />
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<a class="btn btn-default" data-dismiss="modal"> <h:outputText
								value="#{bundle.feedback_close}"></h:outputText>
						</a>
						<h:commandButton styleClass="btn btn-primary hidefeedback"
							value="#{bundle.feedback_send}" action="#{feedbackBean.send}">
							<f:ajax execute="@form" />
						</h:commandButton>
					</div>
				</h:form>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	<!-- /.modal -->

	<ui:insert name="header"></ui:insert>

	<div id="content" class="container">
		<div id="glue-wrap">
			<ui:insert name="content">Main Content</ui:insert>
		</div>

		<ui:insert name="footer">
			<ui:include src="default-footer.xhtml" />
		</ui:insert>

	</div>
	<!-- /container -->

	<!-- <h:outputScript library="js" name="jquery.js" /> -->
	<h:outputScript library="primefaces" name="jquery/jquery.js" />
	<h:outputScript library="js" name="bootstrap.min.js" />
	<h:outputScript library="js" name="handlebars.js" />
	<h:outputScript library="js" name="typeahead.js" />
	<h:outputScript library="js" name="glue.js" />

	<h:outputScript>
	$('input').popover({trigger: 'focus'});
	$('.glue-info-badge').popover({trigger: 'hover'});
    </h:outputScript>
	<h:outputScript>
		$(document).ready(function(){
		$('.carousel').carousel({interval: 15000});
		});
	</h:outputScript>
	<h:outputScript>
		$('.hidefeedback').click(function(e){
   		 	e.preventDefault();
    		$('.modal').modal('hide');
    		return false;
		});
	</h:outputScript>

	<ui:insert name="javascript"></ui:insert>

</h:body>
</f:view>
</html>
